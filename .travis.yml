language: c

compiler:
  - clang
  - gcc

env:
  # At least try stable and mainline versions
  - NGINX_VERSION=1.9.11
  - NGINX_VERSION=1.8.1
  # Also, the oldest supported version
  # TODO: Fails building because it won't find IOV_MAX from header.
  #- NGINX_VERSION=0.7.69

sudo: false

addons:
  apt:
    packages:
      - libpcre3-dev
      - libssl-dev

cache: ccache

script: |
  wget -O - http://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz | tar -xzf -
  cd nginx-${NGINX_VERSION}
  ./configure --add-module=.. --with-http_addition_module
  make
